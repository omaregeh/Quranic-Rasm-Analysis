<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quranic Rasm Analysis Engine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
        }

        .arabic-text {
            font-family: 'Times New Roman', serif;
            font-size: 18px;
            line-height: 1.8;
        }

        .slider-container input[type="range"] {
            appearance: none;
            height: 8px;
            border-radius: 4px;
            background: #e5e7eb;
            outline: none;
        }

        .slider-container input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4f46e5;
            cursor: pointer;
        }

        .gradient-bg {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        }

        .result-card {
            transition: all 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .demo-highlight {
            background: linear-gradient(135deg, #fdf4ff 0%, #f0f9ff 100%);
            border: 2px solid #a855f7;
        }

        .loading-spinner {
            border: 2px solid #f3f4f6;
            border-top: 2px solid #4f46e5;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .border-l-3 {
            border-left-width: 3px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="max-w-7xl mx-auto p-6">
        <div class="bg-white rounded-xl shadow-2xl overflow-hidden">
            <!-- Header -->
            <div class="gradient-bg text-white p-6">
                <div class="flex items-center justify-between">
                    <div class="flex-1">
                        <div class="flex items-center gap-3 mb-2">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                            </svg>
                            <h1 class="text-3xl font-bold">Advanced Quranic Rasm Analysis Engine</h1>
                        </div>
                        <p class="text-indigo-100 text-lg">
                            Complete Surah Analysis with Thematic Interpretation Filters
                        </p>
                        <div class="mt-4 bg-indigo-500 bg-opacity-50 rounded-lg p-3">
                            <p class="text-sm">
                                <strong>Revolutionary Feature:</strong> Analyze entire surahs through different hermeneutical lenses -
                                discover feminist readings, modernist interpretations, mystical insights, and counterintuitive variants
                                hidden within the consonantal skeleton.
                            </p>
                        </div>
                    </div>
                    <div class="ml-6">
                        <button id="resetBtn" class="px-4 py-2 bg-white bg-opacity-20 text-white rounded-lg hover:bg-opacity-30 transition-colors flex items-center gap-2 border border-white border-opacity-30">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                            Reset Demo
                        </button>
                    </div>
                </div>
            </div>

            <!-- Analysis Configuration -->
            <div class="p-6 border-b border-gray-200">
                <div class="flex items-center gap-4 mb-4">
                    <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    <h2 class="text-xl font-semibold text-gray-800">Analysis Configuration</h2>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Mode Selection -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Analysis Scope:</label>
                        <div class="flex gap-4">
                            <button id="verseMode" class="px-4 py-2 rounded-lg transition-colors bg-gray-200 text-gray-700 hover:bg-gray-300">
                                Single Verse
                            </button>
                            <button id="surahMode" class="px-4 py-2 rounded-lg transition-colors bg-indigo-600 text-white">
                                Complete Surah
                            </button>
                        </div>
                    </div>

                    <!-- Counter-intuitive toggle -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Prioritize:</label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" id="counterIntuitiveToggle" checked class="rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                            <span class="text-sm text-gray-700">
                                Counterintuitive & Novel Interpretations First
                            </span>
                            <svg class="w-4 h-4 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                            </svg>
                        </label>
                    </div>
                </div>

                <!-- Hermeneutical Sliders -->
                <div class="mt-6" id="hermSliders">
                    <div class="flex items-center gap-2 mb-4">
                        <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
                        </svg>
                        <h3 class="text-lg font-medium text-gray-800">Hermeneutical Orientation</h3>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="slider-container">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Feminist Reading: <span id="feministValue">50</span>%
                            </label>
                            <input type="range" id="feministSlider" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <p class="text-xs text-gray-500 mt-1">Emphasizes inclusive, egalitarian interpretations</p>
                        </div>

                        <div class="slider-container">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Modernist Reading: <span id="modernistValue">50</span>%
                            </label>
                            <input type="range" id="modernistSlider" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <p class="text-xs text-gray-500 mt-1">Favors contemporary, progressive meanings</p>
                        </div>

                        <div class="slider-container">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Mystical Reading: <span id="mysticalValue">50</span>%
                            </label>
                            <input type="range" id="mysticalSlider" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <p class="text-xs text-gray-500 mt-1">Seeks esoteric, spiritual dimensions</p>
                        </div>

                        <div class="slider-container">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Literalist Reading: <span id="literalistValue">50</span>%
                            </label>
                            <input type="range" id="literalistSlider" min="0" max="100" value="50" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                            <p class="text-xs text-gray-500 mt-1">Prefers traditional, conventional readings</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Input Section -->
            <div class="p-6">
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3" id="inputTitle">
                        Input Complete Surah in Rasm Form
                    </h3>

                    <!-- Sample Texts -->
                    <div class="mb-4">
                        <p class="text-sm text-gray-600 mb-2" id="sampleText">Try these sample surahs:</p>
                        <div class="flex flex-wrap gap-2" id="sampleButtons">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>

                    <div class="flex gap-4">
                        <textarea id="inputText"
                                  placeholder="Enter complete surah in rasm form (one verse per line for surahs)..."
                                  class="flex-1 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-right arabic-text"
                                  rows="8"
                                  dir="rtl"></textarea>
                        <button id="analyzeBtn" class="px-6 py-4 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2">
                            <svg id="analyzeIcon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <span id="analyzeText">Analyze Complete Surah</span>
                        </button>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="resultsSection" class="hidden">
                    <div class="flex items-center gap-2 mb-6">
                        <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                        </svg>
                        <h2 class="text-xl font-semibold text-gray-800" id="resultsTitle">
                            Complete Surah Variants (<span id="resultCount">0</span> interpretations discovered)
                        </h2>
                        <div class="ml-auto flex items-center gap-1 px-2 py-1 bg-yellow-100 rounded-md" id="sortedByNovelty">
                            <svg class="w-4 h-4 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                            </svg>
                            <span class="text-xs text-yellow-700">Sorted by interpretive novelty</span>
                        </div>
                    </div>

                    <!-- Results will be populated here -->
                    <div id="resultsContainer" class="space-y-6">
                        <!-- Results will be dynamically added here -->
                    </div>
                </div>

                <!-- For Professor Nasser Section -->
                <div class="mt-8 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-6">
                    <h3 class="text-lg font-semibold text-indigo-800 mb-4">Revolutionary Methodology:</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm text-indigo-700">
                        <div class="bg-white p-4 rounded-lg border border-indigo-200">
                            <h4 class="font-medium mb-2 flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                </svg>
                                Complete Surah Analysis
                            </h4>
                            <p>Systematically analyzes entire chapters, revealing how individual letter choices affect overall meaning and theological implications across verses.</p>
                        </div>

                        <div class="bg-white p-4 rounded-lg border border-indigo-200">
                            <h4 class="font-medium mb-2 flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
                                </svg>
                                Thematic Hermeneutics
                            </h4>
                            <p>Applies different interpretive lenses (feminist, modernist, mystical, literalist) to discover readings aligned with various theological and philosophical approaches.</p>
                        </div>

                        <div class="bg-white p-4 rounded-lg border border-indigo-200">
                            <h4 class="font-medium mb-2 flex items-center gap-2">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                </svg>
                                Counterintuitive Discovery
                            </h4>
                            <p>Prioritizes novel, unexpected interpretations that challenge traditional readings while maintaining linguistic validity.</p>
                        </div>

                        <div class="bg-white p-4 rounded-lg border border-indigo-200">
                            <h4 class="font-medium mb-2 flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                                </svg>
                                Systematic Permutation
                            </h4>
                            <p>Generates comprehensive combinations of possible dot placements, ensuring no potential reading is overlooked.</p>
                        </div>

                        <div class="bg-white p-4 rounded-lg border border-indigo-200">
                            <h4 class="font-medium mb-2 flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                                </svg>
                                Semantic Validation
                            </h4>
                            <p>Validates each variant for linguistic coherence, historical plausibility, and theological significance.</p>
                        </div>

                        <div class="bg-white p-4 rounded-lg border border-indigo-200">
                            <h4 class="font-medium mb-2 flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                                Multi-dimensional Scoring
                            </h4>
                            <p>Evaluates variants across multiple criteria: novelty, thematic alignment, linguistic validity, and interpretive potential.</p>
                        </div>
                    </div>

                    <div class="mt-6 p-4 bg-gradient-to-r from-yellow-100 to-orange-100 border-l-4 border-yellow-500 rounded">
                        <p class="text-sm text-yellow-800">
                            <strong>For Professor Nasser:</strong> This enhanced system demonstrates how AI can systematically explore
                            the vast interpretive space hidden within the rasm, potentially uncovering suppressed readings that could
                            revolutionize our understanding of early Quranic transmission. The thematic filters allow scholars to
                            discover how different hermeneutical approaches might have emerged from the same consonantal skeleton,
                            revealing the rich interpretive potential that was standardized out during the early canonization process.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // All the v7 functionality in vanilla JavaScript
        let currentMode = 'surah';
        let sliderValues = {
            feminist: 50,
            modernist: 50,
            mystical: 50,
            literalist: 50
        };
        let showCounterIntuitive = true;
        let analysisResults = [];

        // Sample texts data from v7
        const sampleSurahs = [
            {
                name: "Al-Fatiha (Simplified Demo)",
                rasm: `ٮسم الله الرحمٮ الرحٮم
الحمد لله رٮ العالمٮٮ
الرحمٮ الرحٮم
مالك ٮوم الدٮٮ
اٮاك ٮعٮد واٮاك ٮستعٮٮ
اهدٮا الصراط المستقٮم
صراط الذٮٮ اٮعمت علٮهم غٮر المغضوٮ علٮهم ولا الضالٮٮ`,
                description: "Opening chapter with multiple ambiguous letters"
            },
            {
                name: "Al-Ikhlas (Demo)",
                rasm: `قل هو الله احد
الله الصمد
لم ٮلد ولم ٮولد
ولم ٮكٮ له كفوا احد`,
                description: "Chapter on Divine Unity with key ambiguities"
            },
            {
                name: "Al-Asr (Demo)",
                rasm: `والعصر
اٮ الاٮساٮ لفي خسر
الا الذٮٮ امٮوا وعملوا الصالحات وتواصوا ٮالحق وتواصوا ٮالصٮر`,
                description: "Chapter on Time with significant interpretive potential"
            }
        ];

        // Translation templates from v7
        const translationTemplates = {
            'Al-Fatiha': [
                {
                    traditional: "In the name of Allah, the Most Gracious, the Most Merciful",
                    feminist: "In the name of the Divine, the All-Encompassing Nurturer, the Infinitely Compassionate",
                    modernist: "In the name of the Ultimate Reality, the Progressive Force, the Evolutionarily Merciful",
                    mystical: "In the Sacred Name of the Beloved, the Source of All Grace, the Ocean of Mercy"
                },
                {
                    traditional: "Praise be to Allah, Lord of the worlds",
                    feminist: "All gratitude flows to the Divine, Sustainer of all communities and creation",
                    modernist: "Appreciation belongs to the Universal Consciousness, Guide of all peoples and ecosystems",
                    mystical: "Infinite praise to the Beloved, the Heart of all existence"
                },
                {
                    traditional: "The Most Gracious, the Most Merciful",
                    feminist: "The Boundlessly Nurturing, the Unconditionally Loving",
                    modernist: "The Progressively Compassionate, the Systemically Just",
                    mystical: "The Breath of Compassion, the Light of Infinite Love"
                },
                {
                    traditional: "Master of the Day of Judgment",
                    feminist: "Sovereign of the Day of Accountability and Restoration",
                    modernist: "Ultimate Authority of the Era of Justice and Reconciliation",
                    mystical: "Beloved of the Moment of Truth and Return"
                },
                {
                    traditional: "You alone we worship, and You alone we ask for help",
                    feminist: "You alone we honor, and from You alone we seek empowerment",
                    modernist: "You alone we serve, and You alone we seek as our source of transformation",
                    mystical: "In You alone we find our true worship, through You alone flows all assistance"
                },
                {
                    traditional: "Guide us to the straight path",
                    feminist: "Guide us to the path of justice and wholeness",
                    modernist: "Direct us toward the way of ethical progress and authentic living",
                    mystical: "Lead us on the path of divine love and union"
                },
                {
                    traditional: "The path of those You have blessed, not of those who have incurred Your wrath, nor of those who have gone astray",
                    feminist: "The way of those You have honored with wisdom, not of those who perpetuate oppression, nor of those who have lost their way to justice",
                    modernist: "The course of those You have enlightened with progressive consciousness, not of those trapped in harmful patterns, nor of those who reject positive evolution",
                    mystical: "The way of those drowned in Your grace, not of those veiled from love, nor of those wandering far from the Beloved's embrace"
                }
            ],
            'Al-Ikhlas': [
                {
                    traditional: "Say: He is Allah, the One",
                    feminist: "Declare: The Divine is Unity itself, transcending all division",
                    modernist: "Proclaim: Ultimate Reality is singular consciousness and interconnected wholeness",
                    mystical: "Whisper: The Beloved is pure Oneness, beyond all duality"
                },
                {
                    traditional: "Allah, the Eternal, Absolute",
                    feminist: "The Divine, the Self-Sustaining Source of all empowerment",
                    modernist: "Universal Consciousness, the permanent foundation of all existence",
                    mystical: "The Beloved, the Eternal Refuge where all hearts find rest"
                },
                {
                    traditional: "He begets not, nor is He begotten",
                    feminist: "Neither generating nor generated, beyond all hierarchical relationships",
                    modernist: "Neither creating through domination nor created by limitation",
                    mystical: "Neither giving birth to separation nor born from division"
                },
                {
                    traditional: "And there is none comparable to Him",
                    feminist: "And nothing can diminish or define this Sacred Wholeness",
                    modernist: "And no entity or system can parallel this Ultimate Reality",
                    mystical: "And nothing in existence can compare to the Beloved's infinite beauty"
                }
            ],
            'Al-Asr': [
                {
                    traditional: "By time",
                    feminist: "By the sacred rhythm of time that nurtures all growth",
                    modernist: "By the evolutionary process of time that drives progress",
                    mystical: "By time, the divine breath that contains all moments"
                },
                {
                    traditional: "Indeed, mankind is in loss",
                    feminist: "Indeed, humanity struggles when disconnected from wholeness",
                    modernist: "Indeed, human systems often fall short of their potential",
                    mystical: "Indeed, the soul yearns when separated from the Beloved"
                },
                {
                    traditional: "Except for those who have believed and done righteous deeds and advised each other to truth and advised each other to patience",
                    feminist: "Except those who embody faith, work for justice, share wisdom about truth, and support each other through resilience",
                    modernist: "Except those who maintain authentic consciousness, engage in transformative action, promote truthful discourse, and cultivate sustainable perseverance",
                    mystical: "Except those who surrender in love, express divine beauty through action, remind each other of the Real, and companion each other in patient longing"
                }
            ]
        };

        // Initialize the app
        function initializeApp() {
            setupEventListeners();
            populateSampleButtons();
            updateUI();
        }

        function setupEventListeners() {
            // Mode selection
            document.getElementById('verseMode').addEventListener('click', () => setMode('verse'));
            document.getElementById('surahMode').addEventListener('click', () => setMode('surah'));

            // Sliders
            ['feminist', 'modernist', 'mystical', 'literalist'].forEach(type => {
                const slider = document.getElementById(type + 'Slider');
                const valueDisplay = document.getElementById(type + 'Value');

                slider.addEventListener('input', (e) => {
                    sliderValues[type] = parseInt(e.target.value);
                    valueDisplay.textContent = e.target.value;
                });
            });

            // Counter-intuitive toggle
            document.getElementById('counterIntuitiveToggle').addEventListener('change', (e) => {
                showCounterIntuitive = e.target.checked;
            });

            // Analyze button
            document.getElementById('analyzeBtn').addEventListener('click', analyzeText);

            // Reset button
            document.getElementById('resetBtn').addEventListener('click', resetToDefaults);
        }

        function populateSampleButtons() {
            const container = document.getElementById('sampleButtons');
            container.innerHTML = '';

            const samplesToShow = currentMode === 'surah' ? sampleSurahs : [sampleSurahs[0]];

            samplesToShow.forEach((sample, index) => {
                const button = document.createElement('button');
                button.className = 'px-3 py-1 bg-indigo-100 text-indigo-700 rounded-md text-sm hover:bg-indigo-200 transition-colors';
                button.textContent = sample.name;
                button.title = sample.description;
                button.addEventListener('click', () => {
                    document.getElementById('inputText').value = sample.rasm;
                    highlightSelectedSample(button);
                });
                container.appendChild(button);
            });
        }

        function highlightSelectedSample(selectedButton) {
            // Reset all buttons
            document.querySelectorAll('#sampleButtons button').forEach(btn => {
                btn.className = 'px-3 py-1 bg-indigo-100 text-indigo-700 rounded-md text-sm hover:bg-indigo-200 transition-colors';
            });
            // Highlight selected
            selectedButton.className = 'px-3 py-1 bg-indigo-600 text-white rounded-md text-sm transition-colors';
        }

        function setMode(mode) {
            currentMode = mode;
            updateUI();
        }

        function updateUI() {
            // Update mode buttons
            const verseBtn = document.getElementById('verseMode');
            const surahBtn = document.getElementById('surahMode');

            if (currentMode === 'verse') {
                verseBtn.className = 'px-4 py-2 rounded-lg transition-colors bg-indigo-600 text-white';
                surahBtn.className = 'px-4 py-2 rounded-lg transition-colors bg-gray-200 text-gray-700 hover:bg-gray-300';
            } else {
                surahBtn.className = 'px-4 py-2 rounded-lg transition-colors bg-indigo-600 text-white';
                verseBtn.className = 'px-4 py-2 rounded-lg transition-colors bg-gray-200 text-gray-700 hover:bg-gray-300';
            }

            // Show/hide hermeneutical sliders
            const hermSliders = document.getElementById('hermSliders');
            hermSliders.style.display = currentMode === 'surah' ? 'block' : 'none';

            // Update titles and text
            document.getElementById('inputTitle').textContent =
                `Input ${currentMode === 'surah' ? 'Complete Surah' : 'Verse'} in Rasm Form`;
            document.getElementById('sampleText').textContent =
                `Try these sample ${currentMode === 'surah' ? 'surahs' : 'verses'}:`;
            document.getElementById('analyzeText').textContent =
                `Analyze ${currentMode === 'surah' ? 'Complete Surah' : 'Verse'}`;

            // Update sample buttons
            populateSampleButtons();
        }

        function resetToDefaults() {
            currentMode = 'surah';
            sliderValues = { feminist: 50, modernist: 50, mystical: 50, literalist: 50 };
            showCounterIntuitive = true;

            // Reset UI elements
            document.getElementById('counterIntuitiveToggle').checked = true;

            ['feminist', 'modernist', 'mystical', 'literalist'].forEach(type => {
                document.getElementById(type + 'Slider').value = 50;
                document.getElementById(type + 'Value').textContent = '50';
            });

            document.getElementById('inputText').value = sampleSurahs[0].rasm;
            document.getElementById('resultsSection').classList.add('hidden');

            updateUI();
        }

        function analyzeText() {
            const inputText = document.getElementById('inputText').value.trim();
            if (!inputText) return;

            // Update UI for analysis
            const analyzeBtn = document.getElementById('analyzeBtn');
            const analyzeIcon = document.getElementById('analyzeIcon');
            const analyzeText = document.getElementById('analyzeText');

            analyzeBtn.disabled = true;
            analyzeIcon.innerHTML = '<div class="loading-spinner"></div>';
            analyzeText.textContent = `Analyzing ${currentMode}...`;

            // Simulate analysis
            setTimeout(() => {
                generateAndDisplayResults(inputText);

                analyzeBtn.disabled = false;
                analyzeIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>';
                analyzeText.textContent = `Analyze ${currentMode === 'surah' ? 'Complete Surah' : 'Verse'}`;

                showResults();
            }, 3000);
        }

        function generateAndDisplayResults(inputText) {
            if (currentMode === 'surah') {
                analysisResults = generateSurahVariants(inputText);
            } else {
                analysisResults = generateVerseVariants(inputText);
            }

            displayResults();
        }

        function generateSurahVariants(inputText) {
            const verses = inputText.split('\n').filter(v => v.trim());
            const variants = [];

            // Generate 8 variants
            for (let i = 0; i < 8; i++) {
                const variant = createVariant(i, verses, currentMode);
                variants.push(variant);
            }

            // Sort by counter-intuitive score if enabled
            return variants.sort((a, b) => {
                if (showCounterIntuitive) {
                    return b.counterIntuitiveScore - a.counterIntuitiveScore;
                }
                return b.thematicScore - a.thematicScore;
            });
        }

        function generateVerseVariants(inputText) {
            const variants = [];

            for (let i = 0; i < 10; i++) {
                const variant = createVariant(i, [inputText], currentMode);
                variants.push(variant);
            }

            return variants;
        }

        function createVariant(id, verses, mode) {
            // Create mock variant data with dynamic translations
            const translationResult = generateDynamicTranslation(verses);

            return {
                id: id,
                verses: verses,
                fullText: verses.join('\n'),
                dynamicTranslation: translationResult.translations,
                translationNotes: translationResult.methodology,
                dominantHermeneutic: translationResult.dominantApproach,
                explanation: generateMockExplanations(),
                thematicElements: generateThematicElements(),
                thematicScore: Math.random() * 0.5 + 0.5,
                counterIntuitiveScore: Math.random() * 0.8 + 0.2,
                confidence: Math.random() * 0.4 + 0.6,
                linguisticScore: Math.random() * 0.3 + 0.7,
                interpretiveNovelty: Math.random() * 0.5 + 0.5
            };
        }

        function generateDynamicTranslation(verses) {
            // Determine surah type
            let surahType = 'Al-Fatiha';
            if (verses.some(v => v.includes('احد'))) surahType = 'Al-Ikhlas';
            if (verses.some(v => v.includes('العصر'))) surahType = 'Al-Asr';

            const templates = translationTemplates[surahType] || translationTemplates['Al-Fatiha'];

            // Get dominant approach
            const dominantApproach = getDominantApproach();

            // Generate translations
            const translations = templates.slice(0, verses.length).map(template => {
                return template[dominantApproach] || template.traditional;
            });

            return {
                translations: translations,
                methodology: generateMethodologyNote(dominantApproach),
                dominantApproach: dominantApproach
            };
        }

        function getDominantApproach() {
            const approaches = Object.entries(sliderValues);
            approaches.sort((a, b) => b[1] - a[1]);
            return approaches[0][0];
        }

        function generateMethodologyNote(dominantApproach) {
            const notes = {
                feminist: "This translation prioritizes inclusive language, emphasizes divine nurturing aspects, and highlights themes of justice and empowerment.",
                modernist: "This interpretation uses contemporary terminology, emphasizes evolutionary and progressive aspects of the divine message.",
                mystical: "This rendering emphasizes the experiential and mystical dimensions, using language of love, union, and divine intimacy.",
                literalist: "This translation maintains traditional theological terminology and conventional interpretive frameworks."
            };

            let note = notes[dominantApproach];

            // Add secondary influences
            const secondaryApproaches = Object.entries(sliderValues)
                .filter(([key, value]) => key !== dominantApproach && value > 60)
                .map(([key, value]) => `${key} (${value}%)`);

            if (secondaryApproaches.length > 0) {
                note += ` Secondary influences: ${secondaryApproaches.join(', ')}.`;
            }

            return note;
        }

        function generateMockExplanations() {
            const explanations = [
                'V1W2: "ٮ" → "ت" (feminine address)',
                'V2W1: "ٮ" → "ن" (collective pronoun)',
                'V3W3: "ر" → "ز" (adornment/beauty)',
                'V4W2: "س" → "ش" (witnessing)',
                'V5W1: "ف" → "ق" (power/authority)'
            ];

            return explanations.slice(0, Math.floor(Math.random() * 5) + 1);
        }

        function generateThematicElements() {
            const elements = ['feminine-inclusive', 'contemporary-relevant', 'spiritually-deep'];
            const count = Math.floor(Math.random() * 3) + 1;
            return elements.slice(0, count);
        }

        function displayResults() {
            document.getElementById('resultCount').textContent = analysisResults.length;
            document.getElementById('resultsTitle').textContent =
                `${currentMode === 'surah' ? 'Complete Surah Variants' : 'Verse Analysis Results'} (${analysisResults.length} interpretations discovered)`;

            const container = document.getElementById('resultsContainer');
            container.innerHTML = '';

            analysisResults.forEach(variant => {
                const resultElement = createResultElement(variant);
                container.appendChild(resultElement);
            });
        }

        function createResultElement(variant) {
            const div = document.createElement('div');
            div.className = 'border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow result-card';

            div.innerHTML = `
                <div class="p-4 bg-gray-50 cursor-pointer" onclick="toggleDetails(${variant.id})">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex-1">
                            <div class="flex items-center gap-4 mb-2">
                                <h3 class="font-semibold text-gray-800">
                                    ${currentMode === 'surah' ? 'Complete Surah Interpretation' : 'Verse Variant'} #${variant.id + 1}
                                </h3>
                                <div class="flex gap-2">
                                    ${showCounterIntuitive ? `<span class="px-2 py-1 bg-purple-100 text-purple-700 rounded text-xs">
                                        Novelty: ${(variant.counterIntuitiveScore * 100).toFixed(0)}%
                                    </span>` : ''}
                                    <span class="px-2 py-1 bg-green-100 text-green-700 rounded text-xs">
                                        Thematic: ${(variant.thematicScore * 100).toFixed(0)}%
                                    </span>
                                    <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs">
                                        Linguistic: ${(variant.linguisticScore * 100).toFixed(0)}%
                                    </span>
                                </div>
                            </div>

                            ${variant.thematicElements && variant.thematicElements.length > 0 ? `
                                <div class="flex gap-2 mb-2">
                                    ${variant.thematicElements.map(element =>
                                        `<span class="px-2 py-1 bg-indigo-100 text-indigo-700 rounded-full text-xs">${element}</span>`
                                    ).join('')}
                                </div>
                            ` : ''}
                        </div>
                        <svg class="w-5 h-5 transform transition-transform" id="chevron-${variant.id}">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </div>

                    <!-- Display the variant text with translation -->
                    <div class="bg-white rounded-lg p-4 border">
                        ${currentMode === 'surah' ? createSurahDisplay(variant) : createVerseDisplay(variant)}
                    </div>

                    ${variant.explanation && variant.explanation.length > 0 ? `
                        <p class="text-sm text-gray-600 mt-3">
                            Key transformations: ${variant.explanation.slice(0, 3).join(', ')}
                            ${variant.explanation.length > 3 ? ` + ${variant.explanation.length - 3} more changes` : ''}
                        </p>
                    ` : ''}
                </div>

                <div class="hidden p-6 border-t border-gray-200 bg-white" id="details-${variant.id}">
                    ${createDetailedView(variant)}
                </div>
            `;

            return div;
        }

        function createSurahDisplay(variant) {
            return `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Arabic Text -->
                    <div>
                        <h4 class="text-sm font-medium text-gray-700 mb-3 flex items-center gap-2">
                            <span class="w-2 h-2 bg-indigo-500 rounded-full"></span>
                            Arabic Variant
                        </h4>
                        <div class="space-y-3">
                            ${variant.verses.map((verse, idx) => `
                                <div class="text-right bg-gray-50 p-3 rounded arabic-text" dir="rtl">
                                    <span class="text-xs text-gray-500 ml-2">(${idx + 1})</span>
                                    ${verse}
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Dynamic English Translation -->
                    <div>
                        <h4 class="text-sm font-medium text-gray-700 mb-3 flex items-center gap-2">
                            <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
                            Hermeneutically-Informed Translation
                        </h4>
                        <div class="space-y-3">
                            ${variant.dynamicTranslation.map((translation, idx) => `
                                <div class="bg-purple-50 p-3 rounded border-l-3 border-purple-400">
                                    <span class="text-xs text-purple-600 font-medium">(${idx + 1}) </span>
                                    <span class="text-sm text-gray-800 italic">${translation}</span>
                                </div>
                            `).join('')}
                        </div>

                        <!-- Translation Notes -->
                        ${variant.translationNotes ? `
                            <div class="mt-3 p-3 bg-yellow-50 rounded border border-yellow-200">
                                <h5 class="text-xs font-medium text-yellow-800 mb-2">Translation Methodology:</h5>
                                <p class="text-xs text-yellow-700">${variant.translationNotes}</p>
                            </div>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function createVerseDisplay(variant) {
            return `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                    <div class="text-right text-lg bg-gray-50 p-3 rounded arabic-text" dir="rtl">
                        ${variant.fullText}
                    </div>
                    <div class="text-left text-sm bg-purple-50 p-3 rounded border-l-3 border-purple-400 italic">
                        ${variant.dynamicTranslation[0] || 'Translation processing...'}
                    </div>
                </div>
            `;
        }

        function createDetailedView(variant) {
            return `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Transformation Details -->
                    <div>
                        <h4 class="font-medium text-gray-800 mb-3 flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
                            </svg>
                            Detailed Transformations:
                        </h4>
                        <div class="space-y-2 max-h-40 overflow-y-auto">
                            ${variant.explanation && variant.explanation.length > 0 ?
                                variant.explanation.map(change =>
                                    `<div class="text-sm text-gray-600 bg-yellow-50 p-2 rounded border-l-3 border-yellow-400">${change}</div>`
                                ).join('') :
                                '<div class="text-sm text-gray-500 italic">No significant transformations from original rasm</div>'
                            }
                        </div>
                    </div>

                    <!-- Analysis Metrics -->
                    <div>
                        <h4 class="font-medium text-gray-800 mb-3">Interpretive Analysis:</h4>
                        <div class="space-y-3">
                            ${showCounterIntuitive ? `
                                <div class="flex justify-between items-center text-sm">
                                    <span class="flex items-center gap-2">
                                        <svg class="w-4 h-4 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                        </svg>
                                        Counterintuitive Score:
                                    </span>
                                    <div class="flex items-center gap-2">
                                        <div class="w-20 bg-gray-200 rounded-full h-2">
                                            <div class="bg-purple-500 h-2 rounded-full" style="width: ${variant.counterIntuitiveScore * 100}%"></div>
                                        </div>
                                        <span>${(variant.counterIntuitiveScore * 100).toFixed(1)}%</span>
                                    </div>
                                </div>
                            ` : ''}

                            <div class="flex justify-between items-center text-sm">
                                <span>Thematic Alignment:</span>
                                <div class="flex items-center gap-2">
                                    <div class="w-20 bg-gray-200 rounded-full h-2">
                                        <div class="bg-indigo-500 h-2 rounded-full" style="width: ${variant.thematicScore * 100}%"></div>
                                    </div>
                                    <span>${(variant.thematicScore * 100).toFixed(1)}%</span>
                                </div>
                            </div>

                            <div class="flex justify-between items-center text-sm">
                                <span>Linguistic Validity:</span>
                                <div class="flex items-center gap-2">
                                    <div class="w-20 bg-gray-200 rounded-full h-2">
                                        <div class="bg-green-500 h-2 rounded-full" style="width: ${variant.linguisticScore * 100}%"></div>
                                    </div>
                                    <span>${(variant.linguisticScore * 100).toFixed(1)}%</span>
                                </div>
                            </div>

                            ${currentMode === 'surah' ? `
                                <div class="flex justify-between items-center text-sm">
                                    <span>Interpretive Novelty:</span>
                                    <div class="flex items-center gap-2">
                                        <div class="w-20 bg-gray-200 rounded-full h-2">
                                            <div class="bg-orange-500 h-2 rounded-full" style="width: ${variant.interpretiveNovelty * 100}%"></div>
                                        </div>
                                        <span>${(variant.interpretiveNovelty * 100).toFixed(1)}%</span>
                                    </div>
                                </div>
                            ` : ''}
                        </div>

                        ${currentMode === 'surah' ? `
                            <div class="mt-4 p-3 bg-indigo-50 rounded-lg">
                                <h5 class="text-sm font-medium text-indigo-800 mb-2">Hermeneutical Profile:</h5>
                                <div class="grid grid-cols-2 gap-2 text-xs">
                                    <div class="flex justify-between">
                                        <span>Feminist:</span>
                                        <span class="font-medium">${sliderValues.feminist}%</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Modernist:</span>
                                        <span class="font-medium">${sliderValues.modernist}%</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Mystical:</span>
                                        <span class="font-medium">${sliderValues.mystical}%</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Literalist:</span>
                                        <span class="font-medium">${sliderValues.literalist}%</span>
                                    </div>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                </div>

                ${currentMode === 'surah' ? `
                    <div class="mt-6 p-4 bg-blue-50 rounded-lg">
                        <h5 class="font-medium text-blue-800 mb-2">Interpretive Commentary:</h5>
                        <p class="text-sm text-blue-700">
                            This variant demonstrates ${variant.thematicElements.length > 0 ?
                                `${variant.thematicElements.join(', ')} approaches` : 'traditional interpretation'}
                            ${showCounterIntuitive && variant.counterIntuitiveScore > 0.7 ?
                                ', offering a particularly novel perspective that challenges conventional readings.' :
                                ' while maintaining coherence with established linguistic patterns.'}
                            ${variant.counterIntuitiveScore > 0.8 ?
                                ' This reading could potentially reveal previously hidden theological implications.' : ''}
                        </p>
                    </div>
                ` : ''}
            `;
        }

        function toggleDetails(variantId) {
            const detailsEl = document.getElementById(`details-${variantId}`);
            const chevronEl = document.getElementById(`chevron-${variantId}`);

            if (detailsEl.classList.contains('hidden')) {
                detailsEl.classList.remove('hidden');
                chevronEl.style.transform = 'rotate(90deg)';
            } else {
                detailsEl.classList.add('hidden');
                chevronEl.style.transform = 'rotate(0deg)';
            }
        }

        function showResults() {
            const resultsSection = document.getElementById('resultsSection');
            resultsSection.classList.remove('hidden');
            resultsSection.classList.add('fade-in');

            // Scroll to results
            setTimeout(() => {
                resultsSection.scrollIntoView({ behavior: 'smooth' });
            }, 500);
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            initializeApp();

            // Set initial state for demo - Auto-load Al-Fatiha and set slider values
            setTimeout(() => {
                // Set demo values
                sliderValues.modernist = 100;
                sliderValues.mystical = 80;

                // Update UI
                document.getElementById('modernistSlider').value = 100;
                document.getElementById('modernistValue').textContent = '100';
                document.getElementById('mysticalSlider').value = 80;
                document.getElementById('mysticalValue').textContent = '80';

                // Load Al-Fatiha
                document.getElementById('inputText').value = sampleSurahs[0].rasm;

                // Auto-analyze after a delay
                setTimeout(() => {
                    analyzeText();
                }, 1000);
            }, 500);
        });

        // Make toggleDetails available globally
        window.toggleDetails = toggleDetails;
    </script>
</body>
</html>
